Version =19
VersionRequired =19
Checksum =1877792633
Begin Form
    AutoResize = NotDefault
    PopUp = NotDefault
    Modal = NotDefault
    AutoCenter = NotDefault
    GridX =5
    GridY =5
    Width =5669
    ItemSuffix =11
    Left =7590
    Top =3885
    Right =13530
    Bottom =8415
    RecSrcDt = Begin
        0x894e95caffc9e140
    End
    GUID = Begin
        0xd595b9ba63127f468c5094cdbeedb5f4
    End
    NameMap = Begin
        0x0acc0e5500000000465fb7fccab40d4fa024ec8e2b0019c700000000c106e2d0 ,
        0xb849e340000000000000000051005f004d006500730065007300000000000000 ,
        0x1e85050e3aede948af6136756262401607000000465fb7fccab40d4fa024ec8e ,
        0x2b0019c74d006500730000000000000000000000000000000000000000000000 ,
        0x0c000000020000000000000000000000000000000000
    End
    OnCurrent ="[Event Procedure]"
    PrtMip = Begin
        0xae050000ae050000ae050000ae05000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010400059c00c41a43ff8007010009009a0b3408640001000f00580202000100 ,
        0x5802020001004134000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000003020000ffffffff0000000000000000000000000000000044494e55 ,
        0x2200000034029018581ad1fa0000000000000000000000000000000000000000 ,
        0x0000000000000000430000000000000000000000000001000000000000000000 ,
        0x0000000000000500000000000000000001000200000000000000000000000000 ,
        0x0000000001000100010001000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000100000001000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000090180000495550481000110000000000 ,
        0x0200000004000000010000000000000000000000030000000000000000000000 ,
        0x0100010064000100010002000200000001000000020000004100340000000000 ,
        0x0000000000000000000000000000000000000000000000000000000009009a0b ,
        0x34080000ffffffffffffffffffffffff01000000060000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0000000000000000000000000000000000000000000000000000000020005b00 ,
        0x6e0069006e00670075006e0061005d0000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000020005b00 ,
        0x6e0069006e00670075006e0061005d0000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000041007200 ,
        0x690061006c000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000034000000 ,
        0x50000000000000000100000000000000c0c0c00000000000c0c0c00000000000 ,
        0x0000000000000000000000000900000001000000640000000000000000000000 ,
        0x000000000000803f000000000000000000000000000000000000000000000000 ,
        0x00000000010000000000000000000000000000000f0000000101000001000000 ,
        0x0100000001000000000000000000000000000000000000004a0049004d004500 ,
        0x4e0045005a000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000000003c0041007500 ,
        0x74006f006d00e1007400690063006f003e000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000000000000 ,
        0x010000000f00000003020000000000000f000000030200000000000002000000 ,
        0x00000000000000000f000000030200000f000000030200000000000000000000 ,
        0x0000000000000000340800003408000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000302000003020000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000010000000100000049006d007000720065007300 ,
        0x6900f3006e00200063006f00740069006400690061006e006100200067006500 ,
        0x6e006500720061006c0000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0100000000000000000000000000000000000000000000000000000000000000 ,
        0x64000000010000004d006900630072006f0073006f006600740020004f006600 ,
        0x6600690063006500200041006300630065007300730000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000078000000 ,
        0x420c000078000000420c00000000000000000000000000000000000074000000 ,
        0x490c00007b000000430c0000000000000000000000000000000000007a000000 ,
        0x450c000075000000440c000002000000ffffffff4d534143434553532e455845 ,
        0x0000000001000000010000000100000001000000010000000100000001000000 ,
        0x0100000001000000010000000100000001000000010000000100000001000000 ,
        0x0100000001000000010000000100000001000000010000000100000001000000 ,
        0x01000000010000000f000000030200000f000000030200000f00000003020000 ,
        0x0f00000003020000000000000000000000000000030200000000000000000000 ,
        0x000200100000000043003a005c004100720063006800690076006f0073002000 ,
        0x640065002000700072006f006700720061006d0061005c004d00690063007200 ,
        0x6f0073006f006600740020004f00660066006900630065005c004f0046004600 ,
        0x490043004500310031005c004d0053004100430043004500530053002e004500 ,
        0x5800450000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000020000000000000000000000 ,
        0x495041434452574453474154434150491b3bab468734e84581d4df3813513b4b ,
        0x0000000000000000000000000000000000699add8526f8458925ea39aa1078c8
    End
    PrtDevNames = Begin
        0x08001f0036000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000055534230303100
    End
    Begin
        Begin Rectangle
            Width =850
            Height =850
        End
        Begin CommandButton
            TextFontFamily =2
            Width =1701
            Height =283
        End
        Begin ListBox
            Width =1701
            Height =1417
            LabelX =-1701
        End
        Begin ComboBox
            Width =1701
            LabelX =-1701
        End
        Begin Subform
            Width =1701
            Height =1701
        End
        Begin Section
            Height =3855
            BackColor =16776960
            Name ="Detalle0"
            GUID = Begin
                0x462747ae8fea6a4da6e815a782c25747
            End
            Begin
                Begin Label
                    OverlapFlags =85
                    TextAlign =2
                    Left =566
                    Top =113
                    Width =4536
                    Height =455
                    FontSize =12
                    Name ="Texto1"
                    Caption ="Seleccione el mes de pago"
                    GUID = Begin
                        0xe532c442c21aae4ca0ea99cca3bd20d3
                    End
                End
                Begin ListBox
                    RowSourceTypeInt =1
                    OverlapFlags =85
                    Left =2834
                    Top =1360
                    Width =1690
                    Height =1477
                    TabIndex =2
                    Name ="Año_Pago"
                    RowSourceType ="Value List"
                    RowSource ="1999;2000;2001;2002;2003;2004;2005;2006;2007;2008;2009;2010"
                    ColumnWidths ="1440"
                    GUID = Begin
                        0xa9ea5557c66d9a4e89a248d531acdbb9
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =1133
                            Top =1360
                            Width =1125
                            Height =240
                            Name ="Texto5"
                            Caption ="Año de pago :"
                            GUID = Begin
                                0x22445ed1fa40494cae9593b5cce26821
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =3968
                    Top =3061
                    Width =1125
                    Height =465
                    ForeColor =255
                    Name ="B_term_mes_coleg"
                    Caption ="Cerrar"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x631d9f1afea3e64eb41c6784d4fae07e
                    End
                End
                Begin ComboBox
                    OverlapFlags =85
                    ListWidth =1690
                    Left =2834
                    Top =793
                    Width =1690
                    TabIndex =1
                    ColumnInfo ="\"\";\"\";\"10\";\"100\""
                    GUID = Begin
                        0xe25f3305ed0c41468054575d337fd15f
                    End
                    Name ="Mes_Pago"
                    RowSourceType ="Table/Query"
                    RowSource ="Select [Mes] From [Q_Meses];"
                    ColumnWidths ="1440"
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =1133
                            Top =793
                            Width =1125
                            Height =240
                            Name ="Texto10"
                            Caption ="Mes de Pago :"
                            GUID = Begin
                                0x95c6695b63b5214d8ed9a58de01ce457
                            End
                        End
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database   'Usar orden de base de datos en comparaciones de cadenas
Dim db As Database
Dim F_pagos As Form, Nueva_desc
Dim Mes_Ult_Pago, Año_Ult_Pago
Dim T_Coleg As Recordset

Private Sub B_term_mes_coleg_Click()
On Error GoTo Err_B_term_mes_coleg_Click
Dim D_Ind, D_Gral
Dim fecha_compara
    If IsNull([Mes_Pago]) Or IsNull([Año_Pago]) Then
       Beep
       MsgBox "No se pueden tener valores en blanco"
       Exit Sub
    Else
       Set F_pagos = Forms!pagos
       Nueva_desc = "Colegiatura " + [Mes_Pago] + " " + Str([Año_Pago])
       F_pagos![Pagos Operaciones].Form![Operacion] = Nueva_desc
        
       fecha_compara = "1/" + [Mes_Pago] + "/" + Str([Año_Pago])
       If IsDate(fecha_compara) Then
            If DateDiff("m", fecha_compara, Now()) = 0 Then
               If Day(Now()) < 9 Then
                  F_pagos![Pagos Operaciones].Form![Descuento] = F_pagos![Pagos Operaciones].Form![Descuento] - 0.05
               End If
               If Day(Now()) > 17 Then
                  F_pagos![Pagos Operaciones].Form![Descuento] = F_pagos![Pagos Operaciones].Form![Descuento] + 0.05
               End If
            End If
            If DateDiff("m", fecha_compara, Now()) > 0 Then
               F_pagos![Pagos Operaciones].Form![Descuento] = F_pagos![Pagos Operaciones].Form![Descuento] + 0.05
            End If
            If DateDiff("m", fecha_compara, Now()) < 0 Then
               F_pagos![Pagos Operaciones].Form![Descuento] = F_pagos![Pagos Operaciones].Form![Descuento] - 0.05
            End If
       End If


       Set db = CurrentDb()
       Set T_Coleg = db.OpenRecordset("Colegiaturas")
       T_Coleg.AddNew
       T_Coleg!AlumnoID = F_pagos![Pagos Operaciones].Form![Credencial]
       T_Coleg!dig_ver = F_pagos![Pagos Operaciones].Form![dig_ver]
       T_Coleg!Mes = [Mes_Pago]
       T_Coleg!AñoP = [Año_Pago]
       D_Ind = F_pagos![Pagos Operaciones].Form![Descuento]
       D_Gral = F_pagos![DescuentoGeneral]
       T_Coleg!Descuento = ((1 + D_Gral) * (1 + D_Ind)) - 1
       T_Coleg!Precio = F_pagos![Pagos Operaciones].Form![neto]
       T_Coleg!Recibo = F_pagos![Numero]
       T_Coleg!Curso = F_pagos![Pagos Operaciones].Form![Curso]
       T_Coleg!Grupo = F_pagos![Pagos Operaciones].Form![Grupo Alumno]
       T_Coleg!Iva = F_pagos![Pagos Operaciones].Form![Iva]
       T_Coleg.Update

       DoCmd.Close
       DoCmd.GoToControl "Credencial"
       'DoCmd.Requery
       DoCmd.GoToRecord , , acNewRec
       DoCmd.GoToControl "Credencial"
    End If

Exit_B_term_mes_coleg_Click:
    Exit Sub

Err_B_term_mes_coleg_Click:
    MsgBox Error$
    Resume Exit_B_term_mes_coleg_Click
    
End Sub

Private Sub Form_Current()
Dim mes_ingreso, año_ingreso
    Set F_pagos = Forms!pagos

    año_ingreso = DatePart("yyyy", F_pagos![Pagos Otros Datos Alumno].Form![Fecha Ingreso])
    mes_ingreso = DatePart("m", F_pagos![Pagos Otros Datos Alumno].Form![Fecha Ingreso])
    Select Case mes_ingreso
           Case Is = 1
               [Mes_Pago] = "Enero"
           Case Is = 2
               [Mes_Pago] = "Febrero"
           Case Is = 3
               [Mes_Pago] = "Marzo"
           Case Is = 4
               [Mes_Pago] = "Abril"
           Case Is = 5
               [Mes_Pago] = "Mayo"
           Case Is = 6
               [Mes_Pago] = "Junio"
           Case Is = 7
               [Mes_Pago] = "Julio"
           Case Is = 8
               [Mes_Pago] = "Agosto"
           Case Is = 9
               [Mes_Pago] = "Septiembre"
           Case Is = 10
               [Mes_Pago] = "Octubre"
           Case Is = 11
               [Mes_Pago] = "Noviembre"
           Case Is = 12
               [Mes_Pago] = "Diciembre"
    End Select
    [Año_Pago] = año_ingreso

End Sub